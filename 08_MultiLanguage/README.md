# 08 Пример реализации многоязыковой поддержки в приложении Qt

Демонстрация работы приложения с GUI состоящего из объектов, расположенных на форме `MainWindow`:
- от класса `QMenuBar`
- от класса `QLabel`

Необходимо обратить внимание, в пути и названии проекта не должно быть символов кроме: латиницы, цифр и "_-".

В данном примере показано как делать интернационализацию приложения. В общем случае изначально приложение пишется на английском языке в качестве исходника. Затем создаются файлы переводов `*.ts` и выполняется перевод на другие языки с помощью программы **Qt Linguist**. Полученные переводы в файлах `*.ts` компилируются в файлы `*qm`. После чего эти файлы можно подгружать в программу используя объекты класса `QTranslator`.

Для создания файлов с переводами `*.ts` надо:
1. Добавить в файл проекта секцию `TRANSLATIONS += `, где указать пути и файлы перевода. Рекомендуется использовать в названии файла локаль, например `project_ru_RU.ts`, где
    - `project_` - название проекта;
    - `ru` - код языка;
    - `RU` - кода страны;
    - `.ts` - расширение файла.
2. Выполнить программу `lupdate` для создания файлов `*.ts`, например `project_ru_RU.ts`. Можно найти в меню **Инструменты** IDE **Qt Creator**. Там в пункте **Внешние**, надо выбрать подпункт **Linguist**.

Для загрузки скомпилированных файлов переводов `*qm` надо:
1. Выполнить команду `lrelease` для создания файлов `*qm`, например `project_ru_RU.qm`. Также можно найти в меню **Инструменты** IDE **Qt Creator**.
2. В коде должен быть объект класса `QTranslator`, который должен быть подключён к объекту класса `QApplication`, через метод `installTranslator()`.
3. Затем в надо загрузить перевод в этот объект методом `load()`.
4. Выполнить перевод методом `translate()`. Для перевода текста на форме надо вызвать метод `ui->retranslateUi(this)`.

В данном примере используется динамическое меню **Language**, которое формируется исходя из фактического наличия файлов `*qm` в каталоге `translations`. Каталог должен быть расположен там же, где находится исполняемый файл проекта.

Функции перевода `tr()` и `translate()` работают только внутри классов наследников от класса `QObject` с макросом `Q_OBJECT`. Для переводов в отдельных функциях и вне функций есть макросы `QT_TR_NOOP()` и `QT_TRANSLATE_NOOP()`.